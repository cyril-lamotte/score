!function(e){"use strict";window.root={dbName:"score_db",dbVersion:1,appVersion:"1.0.2",env:"prod"},-1!==window.location.href.indexOf("localhost")&&(root.env="dev")}(),root.createDB=function(){var e=root.openDB();e.onupgradeneeded=function(e){(root.db=e.target.result).createObjectStore("players",{autoIncrement:!0}).transaction.oncomplete=function(e){}},e.onsuccess=function(e){root.getLastData()}},root.openDB=function(){var e=indexedDB.open(root.dbName,root.dbVersion);return e.onerror=function(e){console.error(e.target.error)},e.onsuccess=function(e){console.log("Request success")},e},root.deleteDb=function(){var e=indexedDB.deleteDatabase(root.dbName);e.onerror=function(e){console.error("Error deleting database.")},e.onsuccess=function(e){console.log("Database deleted.")}},root.save=function(){root.openDB().onsuccess=function(e){var t=e.target.result.transaction("players","readwrite");t.oncomplete=function(e){},t.onerror=function(e){console.log("Transaction error.")},t.objectStore("players").add(root.data_players).onsuccess=function(){}}},root.initData=function(){for(var e=[],t=!0,o=1;o<=4;o++)o>2&&(t=!1),e.push({id:o,name:"Joueur "+o,score:0,visible:t,update:!1});return e},root.getLastData=function(){root.openDB().onsuccess=function(e){var t=e.target.result.transaction("players","readonly").objectStore("players");t.getAllKeys().onsuccess=function(e){var o=e.target.result,n=o[o.length-1];o.length?t.get(n).onsuccess=function(e){root.data_players=e.target.result,root.initVue()}:(root.data_players=root.initData(),root.initVue())}}},root.mainApp=function(){new Vue({el:"#app",data:{title:"Score",players:root.data_players,modal_visible:!1,options_visible:!1,version:root.appVersion},computed:{player_count:function(){var e=0;return this.players.forEach(function(t,o){t.visible&&e++}),e},inactive_player_count:function(){var e=0;return this.players.forEach(function(t,o){t.visible||e++}),e}},mounted:function(){this.player_count||this.showModal("options")},updated:function(){},methods:{addPlayer:function(){this.players.push({id:this.player_count+1,name:"Joueur X",score:0,visible:!0})},raz:function(){this.players.forEach(function(e,t){e.score=0}),root.save()},showModal:function(e){this.modal_visible=!0,"options"==e&&(this.options_visible=!0)},hideModal:function(e){this.modal_visible=!1,"options"==e&&(this.options_visible=!1)}}})},root.checkCompatibility=function(){"indexedDB"in window||alert("Attention ! Vous pouvez utiliser Score mais votre navigateur ne pourra pas sauvegarder vos parties.")},root.players=function(){Vue.component("player",{props:["player"],template:'<div class="player" :class="{ \'player--zero-point\': player.score <= 0 }"><div class="player__header">  <p class="player__name" contenteditable="true" @blur="rename($event.target.innerHTML)">{{player.name}}</p>  <p class="player__total" @click.prevent="setToZero" :class="{ \'anim-bounce\': player.update }"><button type="button" class="player__score">{{player.score}}</button></p></div><div class="player__action">  <button type="button" @click.prevent="removePoint" class="player__update-btn btn player__update-btn--minus-1"><span class="visually-hidden">Retirer 1 point</span></button>  <button type="button" @click.prevent="addPoint" class="player__update-btn btn player__update-btn--plus-1"><span class="visually-hidden">Ajouter 1 point</span></button></div></div>',methods:{rename:function(e){this.player.name=e,root.save()},addPoint:function(){this.player.score+=1,this.bounce(),root.save()},removePoint:function(){this.player.score-=1,this.bounce(),root.save()},setToZero:function(){this.player.score=0,root.save()},bounce:function(){this.player.update=!0}}}),Vue.component("other_player",{props:["player"],template:'<li><button type="button" @click="setVisible" class="btn">{{ player.name }}</button></li>',methods:{setVisible:function(){this.player.visible=!this.player.visible}}})},function(e){"use strict";root.checkCompatibility(),root.createDB(),root.initVue=function(){root.players(),root.mainApp()}}();